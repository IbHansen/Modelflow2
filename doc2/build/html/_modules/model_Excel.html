<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>model_Excel &mdash; ModelFlow  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="../index.html" class="icon icon-home"> ModelFlow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ModelFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Module code</a> &raquo;</li>
      <li>model_Excel</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for model_Excel</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Fri Feb 12 07:04:02 2016</span>

<span class="sd">@author: ibh</span>

<span class="sd">Takes all formula&#39;s  from a excel work book and translates each to the equivalent expression. </span>
<span class="sd">Openpyxl is the fastest library but it can not deal all values. Therefor xlwings is also used. </span>
<span class="sd">But only to read repeated formula&#39;s which inly will show as &#39;=&#39;</span>



<span class="sd">Also defines function used when using xlwings to automate excel.</span>

<span class="sd">These are used in :any:`modeldump_excel` and :any:`modelload_excel`  </span>

<span class="sd">Some of the docstring are not very informative, to be improved. </span>



<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span> 
<span class="kn">import</span> <span class="nn">openpyxl</span>
<span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.formula</span> <span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="kn">from</span> <span class="nn">openpyxl.utils</span> <span class="kn">import</span> <span class="n">get_column_letter</span>
<span class="kn">from</span> <span class="nn">openpyxl.utils</span> <span class="kn">import</span> <span class="n">cols_from_range</span><span class="p">,</span><span class="n">rows_from_range</span>
<span class="c1"># try:</span>
<span class="c1">#     import xlwings as xw</span>
<span class="c1"># except:</span>
<span class="c1">#     ...</span>
<span class="c1"># import networkx as nx</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span>  <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">modelclass</span> <span class="k">as</span> <span class="nn">mc</span>

<span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="findequations"><a class="viewcode-back" href="../model_Excel.html#model_Excel.findequations">[docs]</a><span class="k">def</span> <span class="nf">findequations</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Takes all formula&#39;s  from a excel work book and translates each to the equivalent expression. </span>
<span class="sd">    </span>
<span class="sd">        Multicell ranges are expanded to a comma separated list. \n</span>
<span class="sd">        The ordinary operators and the SUM function can be handled. If you need more functions. You have to impelent them in the modelclass. </span>
<span class="sd">        </span>
<span class="sd">        In the model each cell reference is prefixed by &lt;sheet name&gt;_</span>
<span class="sd">        </span>
<span class="sd">        Openpyxl is the fastest library and it has a tokenizer</span>
<span class="sd">        but it can not read all values. </span>
<span class="sd">        </span>
<span class="sd">        Therefor xlwings is used to read repeated formula&#39;s which Openpyxl will show as &#39;=&#39;</span>

<span class="sd">    input:</span>
<span class="sd">        :name: Location of a excel sheeet</span>
<span class="sd">    </span>
<span class="sd">         </span>
<span class="sd">        Returns:</span>
<span class="sd">             :modeldic: A dictionary with formulars keyed by cell reference   </span>
<span class="sd">         </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">outdic</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">data_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># to read the spresdsheet first save as xml then write it again </span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb2</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Book</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>    <span class="c1"># the same worksheet in xlwings</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="o">...</span> 
    <span class="c1"># breakpoint()</span>
    
    <span class="n">allsheets</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span>
    <span class="k">for</span> <span class="n">wsname</span> <span class="ow">in</span> <span class="n">allsheets</span><span class="p">:</span>
        <span class="n">ws</span><span class="o">=</span><span class="n">wb</span><span class="p">[</span><span class="n">wsname</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ws2</span><span class="o">=</span><span class="n">wb2</span><span class="o">.</span><span class="n">sheets</span><span class="p">(</span><span class="n">wsname</span><span class="p">)</span>   <span class="c1"># the same sheet but in xlwings</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="o">...</span>
            
        <span class="n">formulacell</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span> 
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">formulacell</span><span class="p">:</span>
            <span class="n">cellref</span><span class="o">=</span><span class="n">get_column_letter</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DEBUG</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This cell:&#39;</span><span class="p">,</span><span class="n">cellref</span><span class="p">,</span><span class="n">cell</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Repeat cell = so xlwings has to be imported </span><span class="si">{</span><span class="n">cell</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">frml</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;=&#39;</span> <span class="k">else</span> <span class="n">ws2</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">cellref</span><span class="p">)</span><span class="o">.</span><span class="n">formula</span> <span class="c1"># To avoid emty repeating formula&#39;rs </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">frml</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> 
            <span class="n">tok</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(</span><span class="n">frml</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DEBUG</span> <span class="ow">and</span> <span class="kc">False</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%19s%15s%9s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">subtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tok</span><span class="o">.</span><span class="n">items</span><span class="p">))</span>
            <span class="c1"># left hand term is &lt;worksheet&gt;!&lt;column&gt;&lt;row&gt;= </span>
            <span class="n">lhs</span><span class="o">=</span><span class="n">wstrans</span><span class="p">(</span><span class="n">wsname</span><span class="p">)</span> <span class="o">+</span> <span class="n">get_column_letter</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">row</span><span class="p">)</span>
            <span class="n">out</span><span class="o">=</span><span class="p">[</span><span class="n">lhs</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tok</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>            
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s2">&quot;RANGE&quot;</span><span class="p">:</span>
                    <span class="c1">#Find or create the sheetname  </span>
                    <span class="n">sheet0</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;!&#39;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="k">else</span> <span class="n">wsname</span>
                    <span class="n">sheet</span>  <span class="o">=</span>  <span class="n">wstrans</span><span class="p">(</span><span class="n">sheet0</span><span class="p">)</span>
                    <span class="c1"># print(t.value,&#39;----&gt;&#39;)</span>
                    <span class="c1"># Get all the cells in the range columwize </span>
                    <span class="c1"># the nested list comprehension makes the list works for square ranges. </span>
                    <span class="c1"># the split construct drops the sheet name from the range name if any </span>
                    <span class="n">thisrange</span><span class="o">=</span><span class="p">[</span><span class="n">sheet</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">subtupler</span> <span class="ow">in</span> <span class="n">cols_from_range</span><span class="p">((</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subtupler</span><span class="p">]</span>

                    <span class="c1"># put a &#39;,&#39; between each element i the list </span>
                    <span class="n">thistext</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">thisrange</span><span class="p">)</span>
                    <span class="c1">#print(thisrange)</span>
                    <span class="n">out</span><span class="o">=</span><span class="n">out</span> <span class="o">+</span> <span class="p">[</span><span class="n">thistext</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="c1">#create the equation and get rid of the !</span>
            <span class="n">equation</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">outdic</span><span class="p">[</span><span class="n">lhs</span><span class="p">]</span><span class="o">=</span><span class="n">equation</span>
            <span class="c1">#print(equation)</span>
    <span class="k">try</span><span class="p">:</span>        
        <span class="n">wb2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span> 
        <span class="o">...</span> 
    <span class="k">return</span> <span class="n">outdic</span>   </div>
    
<div class="viewcode-block" id="showcells"><a class="viewcode-back" href="../model_Excel.html#model_Excel.showcells">[docs]</a><span class="k">def</span> <span class="nf">showcells</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Finds values in a excel workbook with a value different from 0 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">data_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># to read the spresdsheet first save as xml then write it again </span>
    <span class="n">allsheets</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span>
    <span class="k">for</span> <span class="n">wsname</span> <span class="ow">in</span> <span class="n">allsheets</span><span class="p">:</span>
        <span class="n">ws</span><span class="o">=</span><span class="n">wb</span><span class="p">[</span><span class="n">wsname</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">wsname</span><span class="p">,</span><span class="n">get_column_letter</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">column</span> <span class="p">),</span><span class="n">c</span><span class="o">.</span><span class="n">row</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="findvalues"><a class="viewcode-back" href="../model_Excel.html#model_Excel.findvalues">[docs]</a><span class="k">def</span> <span class="nf">findvalues</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Finds numerical values in a excel workbook with a value different from 0 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># to read the spresdsheet first save as xml then write it again </span>
    <span class="n">allsheets</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span>
    <span class="n">values</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">wsname</span> <span class="ow">in</span> <span class="n">allsheets</span><span class="p">:</span>
        <span class="n">ws</span><span class="o">=</span><span class="n">wb</span><span class="p">[</span><span class="n">wsname</span><span class="p">]</span>
        <span class="n">twsname</span> <span class="o">=</span> <span class="n">wstrans</span><span class="p">(</span><span class="n">wsname</span><span class="p">)</span>
        <span class="n">values</span><span class="o">+=</span><span class="p">[(</span><span class="n">twsname</span><span class="o">+</span><span class="n">get_column_letter</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">column</span> <span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">row</span><span class="p">),</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> 
           <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span> 
             <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="p">]</span>  
    <span class="k">return</span> <span class="n">values</span> </div>
    
<div class="viewcode-block" id="wstrans"><a class="viewcode-back" href="../model_Excel.html#model_Excel.wstrans">[docs]</a><span class="k">def</span> <span class="nf">wstrans</span><span class="p">(</span><span class="n">wsname</span><span class="p">):</span>
    <span class="s1">&#39;Translates workspace names&#39;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">wsname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> </div>

<div class="viewcode-block" id="findcoordinates"><a class="viewcode-back" href="../model_Excel.html#model_Excel.findcoordinates">[docs]</a><span class="k">def</span> <span class="nf">findcoordinates</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Finds the cell references matching the codes in a LCR workbook from EBA </span>
<span class="sd">    </span>
<span class="sd">    This is needed for the mapping of the raw data to the excel cell refereces. </span>
<span class="sd">    </span>
<span class="sd">    input:</span>
<span class="sd">        :name: Location of a excel sheeet</span>
<span class="sd">    </span>
<span class="sd">    returns:</span>
<span class="sd">        :coldf: Dataframe with mapping between excel column and EBA columns_code</span>
<span class="sd">        :rowdf: Dataframe with row with mapping between excel row and EBS data row_code</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># to read the spresdsheet first save as xml then write it again </span>
    <span class="n">allsheets</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span>
    
    <span class="n">colcodes</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">rowcodes</span><span class="o">=</span><span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">wsname</span> <span class="ow">in</span> <span class="n">allsheets</span><span class="p">:</span>
        <span class="n">ws</span><span class="o">=</span><span class="n">wb</span><span class="p">[</span><span class="n">wsname</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
        <span class="c1">#find the anchor for the row and columns id, the first </span>
            <span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Row&#39;</span><span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
            <span class="c1"># find the numeric values in the column below the anchor, only the digits and remenber python index starts with 0 while excels index starts with 1 </span>
     
            <span class="n">rowcodes</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">wsname</span> <span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">row</span> <span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">r</span>  
                        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">column</span> <span class="o">==</span> <span class="n">cell</span><span class="o">.</span><span class="n">column</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">row</span> <span class="o">&gt;</span> <span class="n">cell</span><span class="o">.</span><span class="n">row</span> <span class="ow">and</span> 
                              <span class="p">(</span> <span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span> <span class="p">)]</span>
            
    <span class="c1">#         finds the numeric values in the row at the right of the anchor. </span>
            <span class="c1"># c.rows returns a generator (probably because te potential for a huge number) therefor the list(c.rows)</span>
            <span class="n">colcodes</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">wsname</span> <span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="p">,</span> <span class="n">get_column_letter</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">column</span> <span class="p">)</span> <span class="p">)</span>  <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">)[</span><span class="n">cell</span><span class="o">.</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">column</span> <span class="o">&gt;</span> <span class="n">cell</span><span class="o">.</span><span class="n">column</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()))]</span> 
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># Ok this ws did not have an ancor cell </span>
            <span class="k">pass</span>
    <span class="n">coldf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">colcodes</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sheet&#39;</span><span class="p">,</span><span class="s1">&#39;colcode&#39;</span><span class="p">,</span><span class="s1">&#39;col&#39;</span><span class="p">])</span>
    <span class="n">rowdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rowcodes</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sheet&#39;</span><span class="p">,</span><span class="s1">&#39;rowcode&#39;</span><span class="p">,</span><span class="s1">&#39;row&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">coldf</span><span class="p">,</span><span class="n">rowdf</span></div>

<div class="viewcode-block" id="getexcelmodel"><a class="viewcode-back" href="../model_Excel.html#model_Excel.getexcelmodel">[docs]</a><span class="k">def</span> <span class="nf">getexcelmodel</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Creates a model instance from a excel sheet</span>
<span class="sd">    SUM is replaced by SUM_EXCEL which is a function in the modelclass </span>
<span class="sd">    </span>
<span class="sd">    In the excel formulars this function accepts ordinary operators and SUM in excel sheets </span>
<span class="sd">    </span>
<span class="sd">    input:</span>
<span class="sd">        :name: Location of a excel sheeet</span>
<span class="sd">    </span>
<span class="sd">    returns:</span>
<span class="sd">        :model: A model instance with the formulars of the excel sheet</span>
<span class="sd">        :para: A list of values in the sheet which matches exogeneous variables in the model </span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">modelname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>
    <span class="n">eqdic</span>   <span class="o">=</span> <span class="n">findequations</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">eqdic2</span>  <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="p">:</span> <span class="n">eq</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;SUM(&#39;</span><span class="p">,</span><span class="s1">&#39;SUM_EXCEL(&#39;</span><span class="p">)</span>  <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eq</span> <span class="ow">in</span> <span class="n">eqdic</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>                
    <span class="n">fdic</span>    <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="p">:</span> <span class="s1">&#39;Frml xx &#39;</span><span class="o">+</span><span class="n">eqdic2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; $ &#39;</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eq</span> <span class="ow">in</span> <span class="n">eqdic2</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>                
    <span class="n">f</span>       <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">eq</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eq</span> <span class="ow">in</span> <span class="n">fdic</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>                
    <span class="n">_mmodel</span><span class="o">=</span><span class="n">mc</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">modelname</span><span class="o">=</span><span class="n">modelname</span><span class="p">)</span>               
    <span class="n">zz</span> <span class="o">=</span> <span class="n">findvalues</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">para</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">zz</span> <span class="k">if</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">_mmodel</span><span class="o">.</span><span class="n">exogene</span><span class="p">]</span>   <span class="c1"># find all values which match a exogeneous variable in model</span>
    <span class="k">return</span> <span class="n">_mmodel</span><span class="p">,</span><span class="n">para</span></div>

<span class="c1">#%% now functions related to running xlsheets </span>


<div class="viewcode-block" id="indextrans"><a class="viewcode-back" href="../model_Excel.html#model_Excel.indextrans">[docs]</a><span class="k">def</span> <span class="nf">indextrans</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Transforms a period index to excel acceptable datatype </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">year</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">indexes</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">PeriodIndex</span> 
                     <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span> </div>

<div class="viewcode-block" id="df_to_sheet"><a class="viewcode-back" href="../model_Excel.html#model_Excel.df_to_sheet">[docs]</a><span class="k">def</span> <span class="nf">df_to_sheet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">wb</span><span class="p">,</span><span class="n">after</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Dataframe to sheet </span>

<span class="sd">    Args:</span>
<span class="sd">        name (TYPE): DESCRIPTION.</span>
<span class="sd">        df (TYPE): DESCRIPTION.</span>
<span class="sd">        wb (TYPE): DESCRIPTION.</span>
<span class="sd">        after (TYPE, optional): DESCRIPTION. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sht (TYPE): DESCRIPTION.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>  
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sht</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">after</span><span class="o">=</span><span class="n">after</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no sheet added&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">df_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df_</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">indextrans</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">sht</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">df_</span><span class="o">.</span><span class="n">T</span>
    <span class="n">active_window</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ActiveWindow</span>
    <span class="n">active_window</span><span class="o">.</span><span class="n">FreezePanes</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">active_window</span><span class="o">.</span><span class="n">SplitColumn</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">active_window</span><span class="o">.</span><span class="n">SplitRow</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">active_window</span><span class="o">.</span><span class="n">FreezePanes</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">sht</span><span class="o">.</span><span class="n">autofit</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
    <span class="n">sht</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">25</span><span class="p">)]</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">sht</span></div>

<div class="viewcode-block" id="obj_to_sheet"><a class="viewcode-back" href="../model_Excel.html#model_Excel.obj_to_sheet">[docs]</a><span class="k">def</span> <span class="nf">obj_to_sheet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">wb</span><span class="p">,</span><span class="n">after</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    An python object to sheet</span>

<span class="sd">    Args:</span>
<span class="sd">        name (TYPE): DESCRIPTION.</span>
<span class="sd">        obj (TYPE): DESCRIPTION.</span>
<span class="sd">        wb (TYPE): DESCRIPTION.</span>
<span class="sd">        after (TYPE, optional): DESCRIPTION. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># breakpoint()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sht</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">after</span><span class="o">=</span><span class="n">after</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no sheet added &#39;</span><span class="p">)</span>
    <span class="n">sht</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="n">obj</span></div>
    

<div class="viewcode-block" id="sheet_to_df"><a class="viewcode-back" href="../model_Excel.html#model_Excel.sheet_to_df">[docs]</a><span class="k">def</span> <span class="nf">sheet_to_df</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Sheet to df</span>

<span class="sd">    Args:</span>
<span class="sd">        wb (TYPE): DESCRIPTION.</span>
<span class="sd">        name (TYPE): DESCRIPTION.</span>

<span class="sd">    Returns:</span>
<span class="sd">        df (TYPE): DESCRIPTION.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">indextrans</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span> </div>

<div class="viewcode-block" id="sheet_to_dict"><a class="viewcode-back" href="../model_Excel.html#model_Excel.sheet_to_dict">[docs]</a><span class="k">def</span> <span class="nf">sheet_to_dict</span><span class="p">(</span><span class="n">wb</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">integers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; transform the named sheet to a python dict. If we need a integer it has to be in the integer set&#39;&#39;&#39;</span>
    
    <span class="n">integers_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;max_iterations&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="k">else</span> <span class="n">integers</span> 
    <span class="k">try</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="n">out2</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">integers_</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">out2</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">return</span> <span class="n">out2</span></div>
         



    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">testxls</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;exceltest\lcrberegning2.xlsx&#39;</span><span class="p">)</span>
    <span class="n">mmodel</span><span class="p">,</span><span class="n">para</span> <span class="o">=</span> <span class="n">getexcelmodel</span><span class="p">(</span><span class="n">testxls</span><span class="p">)</span>
    <span class="n">eq</span><span class="o">=</span><span class="n">mmodel</span><span class="o">.</span><span class="n">equations</span>
    <span class="n">mmodel</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;_LCR_C62&#39;</span><span class="p">,</span><span class="n">up</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">down</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">HR</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">pdf</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># The LCR </span>
    <span class="n">mmodel</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;_LCR_C25&#39;</span><span class="p">,</span><span class="n">up</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">down</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># liquid assets</span>
    <span class="n">mmodel</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;_LCR_C10&#39;</span><span class="p">,</span><span class="n">up</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Leel 1 covered bonds </span>
    
    <span class="n">c</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">findcoordinates</span><span class="p">(</span><span class="n">testxls</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">findequations</span><span class="p">(</span><span class="n">testxls</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Ib Hansen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>