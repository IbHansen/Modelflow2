<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>model_Excel module &mdash; ModelFlow  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> ModelFlow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">model_Excel module</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ModelFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>model_Excel module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/model_Excel.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-model_Excel">
<span id="model-excel-module"></span><h1>model_Excel module<a class="headerlink" href="#module-model_Excel" title="Permalink to this headline"></a></h1>
<p>Created on Fri Feb 12 07:04:02 2016</p>
<p>&#64;author: ibh</p>
<p>Takes all formula’s  from a excel work book and translates each to the equivalent expression.
Openpyxl is the fastest library but it can not deal all values. Therefor xlwings is also used.
But only to read repeated formula’s which inly will show as ‘=’</p>
<p>Also defines function used when using xlwings to automate excel.</p>
<p>These are used in <a class="reference internal" href="modelclass.html#modelclass.Excel_Mixin.modeldump_excel" title="modelclass.Excel_Mixin.modeldump_excel"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">modeldump_excel</span></code></a> and <a class="reference internal" href="modelclass.html#modelclass.Excel_Mixin.modelload_excel" title="modelclass.Excel_Mixin.modelload_excel"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">modelload_excel</span></code></a></p>
<p>Some of the docstring are not very informative, to be improved.</p>
<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.findequations">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">findequations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#findequations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.findequations" title="Permalink to this definition"></a></dt>
<dd><p>Takes all formula’s  from a excel work book and translates each to the equivalent expression.</p>
<blockquote>
<div><p>Multicell ranges are expanded to a comma separated list.</p>
<p>The ordinary operators and the SUM function can be handled. If you need more functions. You have to impelent them in the modelclass.</p>
<p>In the model each cell reference is prefixed by &lt;sheet name&gt;_</p>
<p>Openpyxl is the fastest library and it has a tokenizer
but it can not read all values.</p>
<p>Therefor xlwings is used to read repeated formula’s which Openpyxl will show as ‘=’</p>
</div></blockquote>
<dl>
<dt>input:</dt><dd><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>Location of a excel sheeet</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">modeldic</dt>
<dd class="field-odd"><p>A dictionary with formulars keyed by cell reference</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.showcells">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">showcells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#showcells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.showcells" title="Permalink to this definition"></a></dt>
<dd><p>Finds values in a excel workbook with a value different from 0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.findvalues">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">findvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#findvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.findvalues" title="Permalink to this definition"></a></dt>
<dd><p>Finds numerical values in a excel workbook with a value different from 0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.wstrans">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">wstrans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wsname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#wstrans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.wstrans" title="Permalink to this definition"></a></dt>
<dd><p>Translates workspace names</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.findcoordinates">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">findcoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#findcoordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.findcoordinates" title="Permalink to this definition"></a></dt>
<dd><p>Finds the cell references matching the codes in a LCR workbook from EBA</p>
<p>This is needed for the mapping of the raw data to the excel cell refereces.</p>
<dl class="simple">
<dt>input:</dt><dd><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>Location of a excel sheeet</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>coldf: Dataframe with mapping between excel column and EBA columns_code
:rowdf: Dataframe with row with mapping between excel row and EBS data row_code</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.getexcelmodel">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">getexcelmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#getexcelmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.getexcelmodel" title="Permalink to this definition"></a></dt>
<dd><p>Creates a model instance from a excel sheet
SUM is replaced by SUM_EXCEL which is a function in the modelclass</p>
<p>In the excel formulars this function accepts ordinary operators and SUM in excel sheets</p>
<dl class="simple">
<dt>input:</dt><dd><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>Location of a excel sheeet</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>model: A model instance with the formulars of the excel sheet
:para: A list of values in the sheet which matches exogeneous variables in the model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.indextrans">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">indextrans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#indextrans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.indextrans" title="Permalink to this definition"></a></dt>
<dd><p>Transforms a period index to excel acceptable datatype</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.df_to_sheet">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">df_to_sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#df_to_sheet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.df_to_sheet" title="Permalink to this definition"></a></dt>
<dd><p>Dataframe to sheet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>df</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>wb</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>after</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sht (TYPE)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.obj_to_sheet">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">obj_to_sheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#obj_to_sheet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.obj_to_sheet" title="Permalink to this definition"></a></dt>
<dd><p>An python object to sheet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>obj</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>wb</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>after</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.sheet_to_df">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">sheet_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#sheet_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.sheet_to_df" title="Permalink to this definition"></a></dt>
<dd><p>Sheet to df</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wb</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>name</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>df (TYPE)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="model_Excel.sheet_to_dict">
<span class="sig-prename descclassname"><span class="pre">model_Excel.</span></span><span class="sig-name descname"><span class="pre">sheet_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/model_Excel.html#sheet_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#model_Excel.sheet_to_dict" title="Permalink to this definition"></a></dt>
<dd><p>transform the named sheet to a python dict. If we need a integer it has to be in the integer set</p>
</dd></dl>

</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Ib Hansen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>